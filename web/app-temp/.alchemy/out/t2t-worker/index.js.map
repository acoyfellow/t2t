{"version":3,"sources":["index.ts"],"sourceRoot":".alchemy/out/t2t-worker","sourcesContent":["import { DurableObject } from 'cloudflare:workers'\n\ntype Env = {\n  MY_DO: DurableObjectNamespace<MyDO>\n}\n\n// TODO: Implement your Durable Object\n// This is a basic key-value store example\nexport class MyDO extends DurableObject {\n  async fetch(request: Request): Promise<Response> {\n    try {\n      const url = new URL(request.url);\n      const key = url.pathname.slice(1); // Remove leading slash\n      \n      if (request.method === 'GET') {\n        // Get a value from storage\n        const value = await this.ctx.storage.get(key);\n        return Response.json({ \n          key, \n          value: value || null,\n          id: this.ctx.id.toString() \n        });\n      }\n\n      if (request.method === 'POST') {\n        // Set a value in storage\n        const body = await request.json() as { value: any };\n        await this.ctx.storage.put(key, body.value);\n        return Response.json({ \n          key, \n          value: body.value,\n          id: this.ctx.id.toString() \n        });\n      }\n\n      if (request.method === 'DELETE') {\n        // Delete a key from storage\n        await this.ctx.storage.delete(key);\n        return Response.json({ \n          key, \n          deleted: true,\n          id: this.ctx.id.toString() \n        });\n      }\n\n      return new Response('Method not allowed', { status: 405 });\n      \n    } catch (error) {\n      console.error('Durable Object error:', error);\n      return new Response(\n        JSON.stringify({ error: 'Storage temporarily unavailable' }), \n        { \n          status: 503, \n          headers: { 'Content-Type': 'application/json' } \n        }\n      );\n    }\n  }\n}\n\n// Worker entry point - routes requests to your Durable Objects\nexport default {\n  async fetch(request: Request, env: Env) {\n    try {\n      const url = new URL(request.url);\n      const pathname = url.pathname;\n\n      // TODO: Add your routing logic here\n      // Example: Route /api/storage/{key} to your Durable Object\n      if (pathname.startsWith('/api/storage/')) {\n        const key = pathname.replace('/api/storage/', '');\n        \n        if (!key || key.length > 50) {\n          return new Response('Invalid key', { status: 400 });\n        }\n\n        // Create or get existing Durable Object instance\n        const id = env.MY_DO.idFromName(key);\n        const doInstance = env.MY_DO.get(id);\n        \n        // Forward request to Durable Object\n        return await doInstance.fetch(request);\n      }\n\n      return new Response(\"Not found\", { status: 404 });\n      \n    } catch (error) {\n      console.error('Worker error:', error);\n      return new Response(\n        JSON.stringify({ error: 'Service temporarily unavailable' }), \n        { \n          status: 503, \n          headers: { 'Content-Type': 'application/json' } \n        }\n      );\n    }\n  }\n};\n"],"mappings":";;;;AAAA,SAAS,qBAAqB;AAQvB,IAAM,OAAN,cAAmB,cAAc;AAAA,EARxC,OAQwC;AAAA;AAAA;AAAA,EACtC,MAAM,MAAM,SAAqC;AAC/C,QAAI;AACF,YAAM,MAAM,IAAI,IAAI,QAAQ,GAAG;AAC/B,YAAM,MAAM,IAAI,SAAS,MAAM,CAAC;AAEhC,UAAI,QAAQ,WAAW,OAAO;AAE5B,cAAM,QAAQ,MAAM,KAAK,IAAI,QAAQ,IAAI,GAAG;AAC5C,eAAO,SAAS,KAAK;AAAA,UACnB;AAAA,UACA,OAAO,SAAS;AAAA,UAChB,IAAI,KAAK,IAAI,GAAG,SAAS;AAAA,QAC3B,CAAC;AAAA,MACH;AAEA,UAAI,QAAQ,WAAW,QAAQ;AAE7B,cAAM,OAAO,MAAM,QAAQ,KAAK;AAChC,cAAM,KAAK,IAAI,QAAQ,IAAI,KAAK,KAAK,KAAK;AAC1C,eAAO,SAAS,KAAK;AAAA,UACnB;AAAA,UACA,OAAO,KAAK;AAAA,UACZ,IAAI,KAAK,IAAI,GAAG,SAAS;AAAA,QAC3B,CAAC;AAAA,MACH;AAEA,UAAI,QAAQ,WAAW,UAAU;AAE/B,cAAM,KAAK,IAAI,QAAQ,OAAO,GAAG;AACjC,eAAO,SAAS,KAAK;AAAA,UACnB;AAAA,UACA,SAAS;AAAA,UACT,IAAI,KAAK,IAAI,GAAG,SAAS;AAAA,QAC3B,CAAC;AAAA,MACH;AAEA,aAAO,IAAI,SAAS,sBAAsB,EAAE,QAAQ,IAAI,CAAC;AAAA,IAE3D,SAAS,OAAO;AACd,cAAQ,MAAM,yBAAyB,KAAK;AAC5C,aAAO,IAAI;AAAA,QACT,KAAK,UAAU,EAAE,OAAO,kCAAkC,CAAC;AAAA,QAC3D;AAAA,UACE,QAAQ;AAAA,UACR,SAAS,EAAE,gBAAgB,mBAAmB;AAAA,QAChD;AAAA,MACF;AAAA,IACF;AAAA,EACF;AACF;AAGA,IAAO,gBAAQ;AAAA,EACb,MAAM,MAAM,SAAkB,KAAU;AACtC,QAAI;AACF,YAAM,MAAM,IAAI,IAAI,QAAQ,GAAG;AAC/B,YAAM,WAAW,IAAI;AAIrB,UAAI,SAAS,WAAW,eAAe,GAAG;AACxC,cAAM,MAAM,SAAS,QAAQ,iBAAiB,EAAE;AAEhD,YAAI,CAAC,OAAO,IAAI,SAAS,IAAI;AAC3B,iBAAO,IAAI,SAAS,eAAe,EAAE,QAAQ,IAAI,CAAC;AAAA,QACpD;AAGA,cAAM,KAAK,IAAI,MAAM,WAAW,GAAG;AACnC,cAAM,aAAa,IAAI,MAAM,IAAI,EAAE;AAGnC,eAAO,MAAM,WAAW,MAAM,OAAO;AAAA,MACvC;AAEA,aAAO,IAAI,SAAS,aAAa,EAAE,QAAQ,IAAI,CAAC;AAAA,IAElD,SAAS,OAAO;AACd,cAAQ,MAAM,iBAAiB,KAAK;AACpC,aAAO,IAAI;AAAA,QACT,KAAK,UAAU,EAAE,OAAO,kCAAkC,CAAC;AAAA,QAC3D;AAAA,UACE,QAAQ;AAAA,UACR,SAAS,EAAE,gBAAgB,mBAAmB;AAAA,QAChD;AAAA,MACF;AAAA,IACF;AAAA,EACF;AACF;","names":[]}